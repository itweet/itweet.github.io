<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="Apache Drill 在基于 SQL 的数据分析和商业智能（BI）上引入了 JSON 文件模型，这使得用户能查询固定架构，演化架构，以及各种格式和数据存储中的模式无关（schema-free）数据。">




  <meta name="keywords" content="SQL,">





  <link rel="alternate" href="/atom.xml" title="WHOAMI">




  <link rel="shortcut icon" type="image/x-icon" href="https://raw.githubusercontent.com/itweet/itweet.github.io/master/favicon.ico?v=1.1">



<link rel="canonical" href="http://itweet.github.io/2015/07/18/drill-use/">


<meta name="description" content="Apache Drill 在基于 SQL 的数据分析和商业智能（BI）上引入了 JSON 文件模型，这使得用户能查询固定架构，演化架构，以及各种格式和数据存储中的模式无关（schema-free）数据。">
<meta name="keywords" content="SQL">
<meta property="og:type" content="article">
<meta property="og:title" content="drill-use">
<meta property="og:url" content="http://itweet.github.io/2015/07/18/drill-use/index.html">
<meta property="og:site_name" content="WHOAMI">
<meta property="og:description" content="Apache Drill 在基于 SQL 的数据分析和商业智能（BI）上引入了 JSON 文件模型，这使得用户能查询固定架构，演化架构，以及各种格式和数据存储中的模式无关（schema-free）数据。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://drill.apache.org/images/home-json.png">
<meta property="og:image" content="http://static.oschina.net/uploads/img/201412/03080605_xXTZ.jpg">
<meta property="og:image" content="http://drill.apache.org/images/home-any.png">
<meta property="og:image" content="http://drill.apache.org/docs/img/connect-plugin.png">
<meta property="og:image" content="http://drill.apache.org/docs/img/plugin-default.png">
<meta property="og:updated_time" content="2019-03-03T09:20:06.440Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="drill-use">
<meta name="twitter:description" content="Apache Drill 在基于 SQL 的数据分析和商业智能（BI）上引入了 JSON 文件模型，这使得用户能查询固定架构，演化架构，以及各种格式和数据存储中的模式无关（schema-free）数据。">
<meta name="twitter:image" content="http://drill.apache.org/images/home-json.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1">
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  



    <title> drill-use - WHOAMI </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">WHOAMI</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/atom.xml">
                            
                            
                                RSS
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          drill-use
        
      </h1>

      <time class="post-time">
          7月 18 2015
      </time>
    </header>



    
            <div class="post-content">
            <p>Apache 软件基金会发起了一项名为“Drill”的开源项目。Apache Drill 实现了   Google’s Dremel.<br>Apache Drill 在基于 SQL 的数据分析和商业智能（BI）上引入了 JSON 文件模型，这使得用户能查询固定架构，演化架构，以及各种格式和数据存储中的模式无关（schema-free）数据。该体系架构中关系查询引擎和数据库的构建是有先决条件的，即假设所有数据都有一个简单的静态架构。<br>Apache Drill的架构是独一无二的。它是唯一一个支持复杂和无模式数据的柱状执行<br>引擎（columnar execution engine），也是唯一一个能在查询执行期间进行数据驱动  查询(和重新编译，也称之为 schema discovery)的执行引擎（execution   engine）。这些独一无二的性能使得 Apache Drill 在 JSON   文件模式下能实现记录断点性能（record-breaking performance）。  </p>
<p>数据结构：<br><img src="http://drill.apache.org/images/home-json.png" alt></p>
<p>兼容已有的 SQL 环境和 Apache Hive：<br><img src="http://static.oschina.net/uploads/img/201412/03080605_xXTZ.jpg" alt></p>
<p>支持多框架：<br><img src="http://drill.apache.org/images/home-any.png" alt></p>
<h1 id="单机模式"><a href="#单机模式" class="headerlink" title="单机模式"></a>单机模式</h1><h2 id="交互窗口-drill-embedded"><a href="#交互窗口-drill-embedded" class="headerlink" title="交互窗口-drill-embedded"></a>交互窗口-drill-embedded</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># wget http://getdrill.org/drill/download/apache-drill-1.0.0.tar.gz</span><br><span class="line"># tar zxf apache-drill-1.0.0.tar.gz </span><br><span class="line"># cd apache-drill-1.0.0</span><br><span class="line"></span><br><span class="line"># bin/drill-embedded </span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M;    support was removed in 8.0</span><br><span class="line">Jul 18, 2015 3:41:25 PM org.glassfish.jersey.server.ApplicationHandler  initialize</span><br><span class="line">INFO: Initiating Jersey application, version Jersey: 2.8 2014-04-29 01:25:26...</span><br><span class="line">apache drill 1.0.0 </span><br><span class="line">&quot;drill baby drill&quot;</span><br><span class="line">0: jdbc:drill:zk=local&gt; use cp;</span><br><span class="line">+-------+---------------------------------+</span><br><span class="line">|  ok   |             summary             |</span><br><span class="line">+-------+---------------------------------+</span><br><span class="line">| true  | Default schema changed to [cp]  |</span><br><span class="line">+-------+---------------------------------+</span><br><span class="line">1 row selected (0.186 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=local&gt; select employee_id,full_name,first_name,last_name from `employee.json` limit 2;</span><br><span class="line">+--------------+------------------+-------------+------------+</span><br><span class="line">| employee_id  |    full_name     | first_name  | last_name  |</span><br><span class="line">+--------------+------------------+-------------+------------+</span><br><span class="line">| 1            | Sheri Nowmer     | Sheri       | Nowmer     |</span><br><span class="line">| 2            | Derrick Whelply  | Derrick     | Whelply    |</span><br><span class="line">+--------------+------------------+-------------+------------+</span><br><span class="line">2 rows selected (0.426 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=local&gt; !quit</span><br><span class="line">Closing: org.apache.drill.jdbc.DrillJdbc41Factory$DrillJdbc41Connection</span><br></pre></td></tr></table></figure>
<h2 id="交互窗口-sqlline"><a href="#交互窗口-sqlline" class="headerlink" title="交互窗口-sqlline"></a>交互窗口-sqlline</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#  bin/sqlline -u jdbc:drill:zk=local</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0</span><br><span class="line">Jul 18, 2015 3:48:12 PM org.glassfish.jersey.server.ApplicationHandler  initialize</span><br><span class="line">INFO: Initiating Jersey application, version Jersey: 2.8 2014-04-29 01:25:26...</span><br><span class="line">apache drill 1.0.0 </span><br><span class="line">&quot;a drill in the hand is better than two in the bush&quot;</span><br><span class="line">0: jdbc:drill:zk=local&gt;</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=local&gt; !quit</span><br><span class="line">Closing: org.apache.drill.jdbc.DrillJdbc41Factory$DrillJdbc41Connection</span><br></pre></td></tr></table></figure>
<h2 id="后台进程方式运行drill"><a href="#后台进程方式运行drill" class="headerlink" title="后台进程方式运行drill"></a>后台进程方式运行drill</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># bin/drillbit.sh start</span><br><span class="line">starting drillbit, logging to /usr/local/apache-drill-1.0.0/log/drillbit.out</span><br><span class="line"></span><br><span class="line"># cat drillbit.out </span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM warning: INFO: os::commit_memory(0x00000006e0000000, 4294967296, 0) failed; error=&apos;Cannot allocate memory&apos; (errno=12)</span><br><span class="line">#</span><br><span class="line"># There is insufficient memory for the Java Runtime Environment to continue.</span><br><span class="line"># Native memory allocation (malloc) failed to allocate 4294967296 bytes for committing reserved memory.</span><br><span class="line"># An error report file with more information is saved as:</span><br><span class="line"># /usr/local/apache-drill-1.0.0/hs_err_pid5344.log</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM warning: INFO: os::commit_memory(0x00000006e0000000, 4294967296, 0) failed; error=&apos;Cannot allocate memory&apos; (errno=12)</span><br><span class="line">#</span><br><span class="line"># There is insufficient memory for the Java Runtime Environment to continue.</span><br><span class="line"># Native memory allocation (malloc) failed to allocate 4294967296 bytes for committing reserved memory.</span><br><span class="line"># An error report file with more information is saved as:</span><br><span class="line"># /usr/local/apache-drill-1.0.0/hs_err_pid5524.log</span><br><span class="line"></span><br><span class="line">增加内存或者修改</span><br><span class="line">DRILL_MAX_DIRECT_MEMORY=&quot;2G&quot; default: 8g</span><br><span class="line">DRILL_HEAP=&quot;1G&quot; default: 4g</span><br><span class="line"></span><br><span class="line">#  bin/drillbit.sh start</span><br><span class="line">starting drillbit, logging to /usr/local/apache-drill-1.0.0/log/drillbit.out</span><br><span class="line"></span><br><span class="line"># ps auwx |grep dirll   #验证后台进程</span><br><span class="line"></span><br><span class="line"># jps -lm</span><br><span class="line">2099 org.apache.hadoop.hdfs.tools.DFSZKFailoverController</span><br><span class="line">1610 org.apache.zookeeper.server.quorum.QuorumPeerMain /usr/local/  zookeeper-3.4.6/bin/../conf/zoo.cfg</span><br><span class="line">6105 sun.tools.jps.Jps -lm</span><br><span class="line">1775 org.apache.hadoop.hdfs.server.namenode.NameNode</span><br><span class="line">5936 org.apache.drill.exec.server.Drillbit</span><br><span class="line">1962 org.apache.hadoop.hdfs.qjournal.server.JournalNode</span><br></pre></td></tr></table></figure>
<p><code>第一个是drillbit的后台进程, 第二个是使用sqlline或者dril-embbed启动的客户端进程</code></p>
<h2 id="Storage-Plugin"><a href="#Storage-Plugin" class="headerlink" title="Storage Plugin"></a>Storage Plugin</h2><blockquote>
<p><a href="http://drill.apache.org/docs/plugin-configuration-basics/" target="_blank" rel="noopener">http://drill.apache.org/docs/plugin-configuration-basics/</a><br><img src="http://drill.apache.org/docs/img/connect-plugin.png" alt></p>
</blockquote>
<ul>
<li>WEBUI：<a href="http://itr-mastertest01:8047/" target="_blank" rel="noopener">http://itr-mastertest01:8047/</a><br>cp是classpath storage plugin, drill的web ui: <a href="http://itr-mastertest01:8047/storage" target="_blank" rel="noopener">http://itr-mastertest01:8047/storage</a><br>Drill支持不同的存储介质, 并且可以从不同的存储介质中使用SQL查询数据.  </li>
</ul>
<p>默认只有cp和dfs是enable的. 在Diabled Storage Plugins中点击某个插件的Enable,   就可以使用这个存储插件了!</p>
<p><img src="http://drill.apache.org/docs/img/plugin-default.png" alt></p>
<h3 id="1、添加HDFS插件"><a href="#1、添加HDFS插件" class="headerlink" title="1、添加HDFS插件"></a>1、添加HDFS插件</h3><p>点击Create,在Configuration中输入hdfs的存储插件配置信息:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;file&quot;,</span><br><span class="line">  &quot;enabled&quot;: true,</span><br><span class="line">  &quot;connection&quot;: &quot;hdfs://itr-mastertest01:9000/&quot;,</span><br><span class="line">  &quot;workspaces&quot;: &#123;</span><br><span class="line">    &quot;root&quot;: &#123;</span><br><span class="line">      &quot;location&quot;: &quot;/tmp&quot;,</span><br><span class="line">      &quot;writable&quot;: true,</span><br><span class="line">      &quot;defaultInputFormat&quot;: null</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;formats&quot;: &#123;</span><br><span class="line">    &quot;csv&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">      &quot;extensions&quot;: [</span><br><span class="line">        &quot;csv&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;delimiter&quot;: &quot;,&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;tsv&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">      &quot;extensions&quot;: [</span><br><span class="line">        &quot;tsv&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;delimiter&quot;: &quot;\t&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;parquet&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;parquet&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="2、设置dfs-hdfs工作目录"><a href="#2、设置dfs-hdfs工作目录" class="headerlink" title="2、设置dfs/hdfs工作目录"></a>2、设置dfs/hdfs工作目录</h3><ul>
<li><p>dfs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;file&quot;,</span><br><span class="line">  &quot;enabled&quot;: true,</span><br><span class="line">  &quot;connection&quot;: &quot;file:///&quot;,</span><br><span class="line">  &quot;workspaces&quot;: &#123;</span><br><span class="line">    &quot;root&quot;: &#123;</span><br><span class="line">      &quot;location&quot;: &quot;/&quot;,</span><br><span class="line">      &quot;writable&quot;: false,</span><br><span class="line">      &quot;defaultInputFormat&quot;: null</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;tmp&quot;: &#123;</span><br><span class="line">      &quot;location&quot;: &quot;/tmp&quot;,</span><br><span class="line">      &quot;writable&quot;: true,</span><br><span class="line">      &quot;defaultInputFormat&quot;: null</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;work&quot;: &#123;</span><br><span class="line">      &quot;location&quot;: &quot;/usr/local/apache-drill-1.0.0/&quot;,</span><br><span class="line">      &quot;writable&quot;: true,</span><br><span class="line">      &quot;defaultInputFormat&quot;: null</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;formats&quot;: &#123;</span><br><span class="line">    &quot;csv&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">      &quot;extensions&quot;: [</span><br><span class="line">        &quot;csv&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;delimiter&quot;: &quot;,&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;tsv&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">      &quot;extensions&quot;: [</span><br><span class="line">        &quot;tsv&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;delimiter&quot;: &quot;\t&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;parquet&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;parquet&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>hdfs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;file&quot;,</span><br><span class="line">  &quot;enabled&quot;: true,</span><br><span class="line">  &quot;connection&quot;: &quot;hdfs://mycluster/&quot;,</span><br><span class="line">  &quot;workspaces&quot;: &#123;</span><br><span class="line">    &quot;root&quot;: &#123;</span><br><span class="line">      &quot;location&quot;: &quot;/&quot;,</span><br><span class="line">      &quot;writable&quot;: true,</span><br><span class="line">      &quot;defaultInputFormat&quot;: null</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;formats&quot;: &#123;</span><br><span class="line">    &quot;csv&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">      &quot;extensions&quot;: [</span><br><span class="line">        &quot;csv&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;delimiter&quot;: &quot;,&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;tsv&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;text&quot;,</span><br><span class="line">      &quot;extensions&quot;: [</span><br><span class="line">        &quot;tsv&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;delimiter&quot;: &quot;\t&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;parquet&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;parquet&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">  对于hdfs也可以自定义一个自己的工作空间比如work=/user/hive/. 则定位到/user/hive/下,  直接使用hdfs.work进行查询</span><br></pre></td></tr></table></figure>
</li>
<li><p>hive </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;hive&quot;,</span><br><span class="line">  &quot;enabled&quot;: true,</span><br><span class="line">  &quot;configProps&quot;: &#123;</span><br><span class="line">    &quot;hive.metastore.uris&quot;: &quot;thrift://itr-mastertest02:9083&quot;,</span><br><span class="line">    &quot;javax.jdo.option.ConnectionURL&quot;: &quot;jdbc:mysql://itr-mastertest02:3306/hive?characterEncoding=UTF-8&quot;,</span><br><span class="line">    &quot;hive.metastore.warehouse.dir&quot;: &quot;/user/hive/warehouse&quot;,</span><br><span class="line">    &quot;fs.default.name&quot;: &quot;hdfs://mycluster&quot;,</span><br><span class="line">    &quot;hive.metastore.sasl.enabled&quot;: &quot;false&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>hbase</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;hbase&quot;,</span><br><span class="line">  &quot;config&quot;: &#123;</span><br><span class="line">    &quot;hbase.zookeeper.quorum&quot;: &quot;itr-mastertest01,itr-mastertest02,itr-nodetest01&quot;,</span><br><span class="line">    &quot;hbase.zookeeper.property.clientPort&quot;: &quot;2181&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;size.calculator.enabled&quot;: false,</span><br><span class="line">  &quot;enabled&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>rdbms</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;jdbc&quot;,</span><br><span class="line">  &quot;driver&quot;: &quot;com.mysql.jdbc.Driver&quot;,</span><br><span class="line">  &quot;url&quot;: &quot;jdbc:mysql://itr-mastertest01:3306&quot;,</span><br><span class="line">  &quot;username&quot;: &quot;root&quot;,</span><br><span class="line">  &quot;password&quot;: &quot;admin&quot;,</span><br><span class="line">  &quot;enabled&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3、测试dfs-hdfs"><a href="#3、测试dfs-hdfs" class="headerlink" title="3、测试dfs/hdfs"></a>3、测试dfs/hdfs</h3><p>  测试部分放到分布式中</p>
<h1 id="分布式"><a href="#分布式" class="headerlink" title="分布式"></a>分布式</h1><h2 id="1、修改配置文件"><a href="#1、修改配置文件" class="headerlink" title="1、修改配置文件"></a>1、修改配置文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># tail -4 drill-override.conf  </span><br><span class="line">drill.exec: &#123;</span><br><span class="line">  cluster-id: &quot;drillbits1&quot;,</span><br><span class="line">  zk.connect: &quot;itr-mastertest01:2181,itr-mastertest02:2181,itr-nodetest01:2181&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>每台节点的cluster-id都是一样的. 保证了所有的节点组成一个集群.把安装目录复制到所有节点相同目录下！</p>
</blockquote>
<h2 id="2、启动集群"><a href="#2、启动集群" class="headerlink" title="2、启动集群"></a>2、启动集群</h2><ul>
<li>然后在每台机器上都启动bin/drillbit.sh start</li>
<li>随便访问任意一台机器的8047端口, 都可以列出集群中的所有drill服务,并且看到节点</li>
</ul>
<h2 id="3、客户端连接"><a href="#3、客户端连接" class="headerlink" title="3、客户端连接"></a>3、客户端连接</h2><p>  Drill提供了一些工具, 包括第三方工具也提供了访问Drill数据的方法.<br>  主要是Drill和其他SQL DB一样提供了一个ODBC Driver.<br>  参考: <a href="https://drill.apache.org/docs/interfaces-introduction/" target="_blank" rel="noopener">https://drill.apache.org/docs/interfaces-introduction/</a><br>  例：jdbc:drill:zk=10.10.100.30:5181,10.10.100.31:5181,10.10.100.32:5181/drill/drillbits1;schema=hive</p>
<ul>
<li><p>连接本地ZK</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/sqlline -u jdbc:drill:zk=local</span><br></pre></td></tr></table></figure>
</li>
<li><p>连接ZK集群(sqlline)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># drill/bin/sqlline -u jdbc:drill:zk=itr-mastertest01:2181,itr-mastertest02:2181,itr-nodetest01:2181</span><br><span class="line"></span><br><span class="line">`如果是集群模式, 也可以不跟上zk地址: bin/sqlline -u jdbc:drill:zk 会自动读取drill-override.conf的配置`</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt;  select employee_id,full_name from cp.`employee.json` limit 2;</span><br><span class="line">+--------------+------------------+</span><br><span class="line">| employee_id  |    full_name     |</span><br><span class="line">+--------------+------------------+</span><br><span class="line">| 1            | Sheri Nowmer     |</span><br><span class="line">| 2            | Derrick Whelply  |</span><br><span class="line">+--------------+------------------+</span><br><span class="line">2 rows selected (0.457 seconds)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="dfs源"><a href="#dfs源" class="headerlink" title="dfs源"></a>dfs源</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from dfs.`sample-data/region.parquet` limit 2;</span><br><span class="line">Error: PARSE ERROR: From line 1, column 15 to line 1, column 17: Table &apos;dfs.sample-data/region.parquet&apos; not found</span><br><span class="line">[Error Id: 9d20015d-023a-4d06-80d2-78760a037aed on itr-mastertest02:31010] (state=,code=0)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from dfs.work.`sample-data/region.parquet` limit 2;</span><br><span class="line">+--------------+----------+-----------------------+</span><br><span class="line">| R_REGIONKEY  |  R_NAME  |       R_COMMENT       |</span><br><span class="line">+--------------+----------+-----------------------+</span><br><span class="line">| 0            | AFRICA   | lar deposits. blithe  |</span><br><span class="line">| 1            | AMERICA  | hs use ironic, even   |</span><br><span class="line">+--------------+----------+-----------------------+</span><br><span class="line">2 rows selected (0.517 seconds)</span><br></pre></td></tr></table></figure>
<h3 id="hdfs源"><a href="#hdfs源" class="headerlink" title="hdfs源"></a>hdfs源</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"># hadoop fs -ls /data         </span><br><span class="line">Found 1 items</span><br><span class="line">-rw-r--r--   2 root supergroup        455 2015-07-18 22:35 /data/regionsSF.parquet</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select count(*) from hdfs.`/data`;</span><br><span class="line">+---------+</span><br><span class="line">| EXPR$0  |</span><br><span class="line">+---------+</span><br><span class="line">| 5       |</span><br><span class="line">+---------+</span><br><span class="line">1 row selected (0.773 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select count(*) from hdfs.`/data/regionsSF.parquet`;</span><br><span class="line">+---------+</span><br><span class="line">| EXPR$0  |</span><br><span class="line">+---------+</span><br><span class="line">| 5       |</span><br><span class="line">+---------+</span><br><span class="line">1 row selected (0.146 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select count(*) from hdfs.`hdfs://mycluster/data/regionsSF.parquet`;</span><br><span class="line">+---------+</span><br><span class="line">| EXPR$0  |</span><br><span class="line">+---------+</span><br><span class="line">| 5       |</span><br><span class="line">+---------+</span><br><span class="line">1 row selected (0.173 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; use hdfs.work;</span><br><span class="line">+-------+----------------------------------------+</span><br><span class="line">|  ok   |                summary                 |</span><br><span class="line">+-------+----------------------------------------+</span><br><span class="line">| true  | Default schema changed to [hdfs.work]  |</span><br><span class="line">+-------+----------------------------------------+</span><br><span class="line">1 row selected (0.095 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; use sys;</span><br><span class="line">+-------+----------------------------------+</span><br><span class="line">|  ok   |             summary              |</span><br><span class="line">+-------+----------------------------------+</span><br><span class="line">| true  | Default schema changed to [sys]  |</span><br><span class="line">+-------+----------------------------------+</span><br><span class="line">1 row selected (0.136 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; show tables;</span><br><span class="line">+---------------+-------------+</span><br><span class="line">| TABLE_SCHEMA  | TABLE_NAME  |</span><br><span class="line">+---------------+-------------+</span><br><span class="line">| sys           | boot        |</span><br><span class="line">| sys           | drillbits   |</span><br><span class="line">| sys           | memory      |</span><br><span class="line">| sys           | options     |</span><br><span class="line">| sys           | threads     |</span><br><span class="line">| sys           | version     |</span><br><span class="line">+---------------+-------------+</span><br><span class="line">6 rows selected (0.138 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; use hdfs;</span><br><span class="line">+-------+-----------------------------------+</span><br><span class="line">|  ok   |              summary              |</span><br><span class="line">+-------+-----------------------------------+</span><br><span class="line">| true  | Default schema changed to [hdfs]  |</span><br><span class="line">+-------+-----------------------------------+</span><br><span class="line">1 row selected (0.094 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; use tmp;</span><br><span class="line">+-------+---------------------------------------+</span><br><span class="line">|  ok   |                summary                |</span><br><span class="line">+-------+---------------------------------------+</span><br><span class="line">| true  | Default schema changed to [hdfs.tmp]  |</span><br><span class="line">+-------+---------------------------------------+</span><br><span class="line">1 row selected (0.1 seconds)</span><br></pre></td></tr></table></figure>
<h3 id="hive-数据源"><a href="#hive-数据源" class="headerlink" title="hive 数据源"></a>hive 数据源</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; use hive;</span><br><span class="line">+-------+-----------------------------------+</span><br><span class="line">|  ok   |              summary              |</span><br><span class="line">+-------+-----------------------------------+</span><br><span class="line">| true  | Default schema changed to [hive]  |</span><br><span class="line">+-------+-----------------------------------+</span><br><span class="line">1 row selected (0.804 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; show tables;</span><br><span class="line">+---------------+---------------------+</span><br><span class="line">| TABLE_SCHEMA  |     TABLE_NAME      |</span><br><span class="line">+---------------+---------------------+</span><br><span class="line">| hive.default  | order_test          |</span><br><span class="line">| hive.default  | order_test_parquet  |</span><br><span class="line">+---------------+---------------------+</span><br><span class="line">2 rows selected (0.462 seconds)    </span><br><span class="line"></span><br><span class="line">查询报错：</span><br><span class="line">Error: SYSTEM ERROR: java.net.UnknownHostException: mycluster</span><br><span class="line">[Error Id: 10ba19e9-35fd-4457-8fa5-8c6f41313b3a on itr-mastertest02:31010] (state=,code=0)</span><br><span class="line"> select count(*) from hdfs.`testdata/db_case1/order_created`;</span><br><span class="line">Error: PARSE ERROR: From line 1, column 22 to line 1, column 25: Table &apos;hdfs.testdata/db_case1/order_created&apos; not found</span><br><span class="line"></span><br><span class="line">解决：</span><br><span class="line"># vim drill-env.sh </span><br><span class="line">export HADOOP_HOME=&quot;/usr/local/hadoop&quot;</span><br><span class="line"></span><br><span class="line">#text table</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from hive.`order_test`;</span><br><span class="line">+-----------------+-----------------------------+</span><br><span class="line">|   ordernumber   |         event_time          |</span><br><span class="line">+-----------------+-----------------------------+</span><br><span class="line">| 10703007267488  | 2014-05-01 06:01:12.334+01  |</span><br><span class="line">| 10101043505096  | 2014-05-01 07:28:12.342+01  |</span><br><span class="line">| 10103043509747  | 2014-05-01 07:50:12.33+01   |</span><br><span class="line">| 10103043501575  | 2014-05-01 09:27:12.33+01   |</span><br><span class="line">| 10104043514061  | 2014-05-01 09:03:12.324+01  |</span><br><span class="line">+-----------------+-----------------------------+</span><br><span class="line">5 rows selected (0.819 seconds)</span><br><span class="line"></span><br><span class="line">#parquet table</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from hive.`order_test_parquet`;</span><br><span class="line">+-----------------+-----------------------------+</span><br><span class="line">|   ordernumber   |         event_time          |</span><br><span class="line">+-----------------+-----------------------------+</span><br><span class="line">| 10703007267488  | 2014-05-01 06:01:12.334+01  |</span><br><span class="line">| 10101043505096  | 2014-05-01 07:28:12.342+01  |</span><br><span class="line">| 10103043509747  | 2014-05-01 07:50:12.33+01   |</span><br><span class="line">| 10103043501575  | 2014-05-01 09:27:12.33+01   |</span><br><span class="line">| 10104043514061  | 2014-05-01 09:03:12.324+01  |</span><br><span class="line">+-----------------+-----------------------------+</span><br><span class="line">5 rows selected (0.522 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; show databases;</span><br><span class="line">+---------------------+</span><br><span class="line">|     SCHEMA_NAME     |</span><br><span class="line">+---------------------+</span><br><span class="line">| INFORMATION_SCHEMA  |</span><br><span class="line">| cp.default          |</span><br><span class="line">| dfs.default         |</span><br><span class="line">| dfs.root            |</span><br><span class="line">| dfs.tmp             |</span><br><span class="line">| dfs.work            |</span><br><span class="line">| hdfs.default        |</span><br><span class="line">| hdfs.root           |</span><br><span class="line">| hdfs.tmp            |</span><br><span class="line">| hdfs.work           |</span><br><span class="line">| hive.default        |</span><br><span class="line">| hive.hsu            |</span><br><span class="line">| sys                 |</span><br><span class="line">+---------------------+</span><br><span class="line">13 rows selected (0.14 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select count(*) from hive.`default`.order_test;</span><br><span class="line">+---------+</span><br><span class="line">| EXPR$0  |</span><br><span class="line">+---------+</span><br><span class="line">| 5       |</span><br><span class="line">+---------+</span><br><span class="line">1 row selected (0.27 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; create table hive.`default`.test as select * from hive.`default`.order_test;</span><br><span class="line">Error: PARSE ERROR: Unable to create or drop tables/views. Schema [hive.    default] is immutable.</span><br></pre></td></tr></table></figure>
<p>参考：<a href="http://drill.apache.org/docs/querying-hive/" target="_blank" rel="noopener">http://drill.apache.org/docs/querying-hive/</a></p>
<h3 id="hbase数据源"><a href="#hbase数据源" class="headerlink" title="hbase数据源"></a>hbase数据源</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):001:0&gt; list</span><br><span class="line">TABLE                                                                                                                                    </span><br><span class="line">ABC                                                                                                                                      </span><br><span class="line">SYSTEM.CATALOG                                                                                                                           </span><br><span class="line">SYSTEM.SEQUENCE                                                                                                                          </span><br><span class="line">SYSTEM.STATS                                                                                                                             </span><br><span class="line">TEST                                                                                                                                     </span><br><span class="line">TEST01                                                                                                                                   </span><br><span class="line">6 row(s) in 2.9470 seconds</span><br><span class="line"></span><br><span class="line">=&gt; [&quot;ABC&quot;, &quot;SYSTEM.CATALOG&quot;, &quot;SYSTEM.SEQUENCE&quot;, &quot;SYSTEM.STATS&quot;, &quot;TEST&quot;, &quot;TEST01&quot;]</span><br><span class="line"></span><br><span class="line">hbase(main):008:0&gt; scan &apos;TEST01&apos;</span><br><span class="line">ROW                                 COLUMN+CELL                                                                                          </span><br><span class="line"> user1|ts1                          column=sf:c1, timestamp=1426423837228, value=sku1                                                    </span><br><span class="line">1 row(s) in 0.0840 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):009:0&gt; scan &apos;TEST&apos;</span><br><span class="line">ROW                                 COLUMN+CELL                                                                                          </span><br><span class="line"> \x80\x00\x00\x01                   column=0:MYCOLUMN, timestamp=1426421982186, value=Hello                                              </span><br><span class="line"> \x80\x00\x00\x01                   column=0:_0, timestamp=1426421982186, value=                                                         </span><br><span class="line"> \x80\x00\x00\x02                   column=0:MYCOLUMN, timestamp=1426421982186, value=World!                                             </span><br><span class="line"> \x80\x00\x00\x02                   column=0:_0, timestamp=1426421982186, value=                                                         </span><br><span class="line">2 row(s) in 0.0290 seconds</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; use hbase;</span><br><span class="line">+-------+------------------------------------+</span><br><span class="line">|  ok   |              summary               |</span><br><span class="line">+-------+------------------------------------+</span><br><span class="line">| true  | Default schema changed to [hbase]  |</span><br><span class="line">+-------+------------------------------------+</span><br><span class="line">1 row selected (2.393 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; show tables;</span><br><span class="line">+---------------+------------------+</span><br><span class="line">| TABLE_SCHEMA  |    TABLE_NAME    |</span><br><span class="line">+---------------+------------------+</span><br><span class="line">| hbase         | ABC              |</span><br><span class="line">| hbase         | SYSTEM.CATALOG   |</span><br><span class="line">| hbase         | SYSTEM.SEQUENCE  |</span><br><span class="line">| hbase         | SYSTEM.STATS     |</span><br><span class="line">| hbase         | TEST             |</span><br><span class="line">| hbase         | TEST01           |</span><br><span class="line">+---------------+------------------+</span><br><span class="line">6 rows selected (5.415 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from hbase.TEST01;</span><br><span class="line">+-------------+-------+--------------------+</span><br><span class="line">|   row_key   |  lf   |         sf         |</span><br><span class="line">+-------------+-------+--------------------+</span><br><span class="line">| [B@a32b2dc  | null  | &#123;&quot;c1&quot;:&quot;c2t1MQ==&quot;&#125;  |</span><br><span class="line">+-------------+-------+--------------------+</span><br><span class="line">1 row selected (1.825 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select count(*) from hbase.TEST01;</span><br><span class="line">+---------+</span><br><span class="line">| EXPR$0  |</span><br><span class="line">+---------+</span><br><span class="line">| 1       |</span><br><span class="line">+---------+</span><br><span class="line">1 row selected (2.244 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select cast(row_key as VarChar(20)),lf,sf from hbase.TEST01;</span><br><span class="line">+------------+-----+--------------------+</span><br><span class="line">|   EXPR$0   | lf  |         sf         |</span><br><span class="line">+------------+-----+--------------------+</span><br><span class="line">| user1|ts1  | &#123;&#125;  | &#123;&quot;c1&quot;:&quot;c2t1MQ==&quot;&#125;  |</span><br><span class="line">+------------+-----+--------------------+</span><br><span class="line">1 row selected (2.305 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select count(*) from hbase.`SYSTEM.CATALOG`;</span><br><span class="line">+---------+</span><br><span class="line">| EXPR$0  |</span><br><span class="line">+---------+</span><br><span class="line">| 79      |</span><br><span class="line">+---------+</span><br><span class="line">1 row selected (0.815 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select CONVERT_FROM(row_key,&apos;UTF8&apos;) from hbase.TEST;</span><br><span class="line">+---------+</span><br><span class="line">| EXPR$0  |</span><br><span class="line">+---------+</span><br><span class="line">| ?    |</span><br><span class="line">| ?    |</span><br><span class="line">+---------+</span><br><span class="line">2 rows selected (0.699 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from hbase.TEST;</span><br><span class="line">+--------------+----------------------------------+</span><br><span class="line">|   row_key    |                0                 |</span><br><span class="line">+--------------+----------------------------------+</span><br><span class="line">| [B@5b6c4eba  | &#123;&quot;MYCOLUMN&quot;:&quot;SGVsbG8=&quot;,&quot;_0&quot;:&quot;&quot;&#125;  |</span><br><span class="line">| [B@23a4c43a  | &#123;&quot;MYCOLUMN&quot;:&quot;V29ybGQh&quot;,&quot;_0&quot;:&quot;&quot;&#125;  |</span><br><span class="line">+--------------+----------------------------------+</span><br><span class="line">2 rows selected (0.554 seconds)</span><br></pre></td></tr></table></figure>
<h1 id="MYSQL"><a href="#MYSQL" class="headerlink" title="MYSQL"></a>MYSQL</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:drill:zk=bigdata-test-server-02:2181&gt; use mysql.test;</span><br><span class="line">+-------+-----------------------------------------+</span><br><span class="line">|  ok   |                 summary                 |</span><br><span class="line">+-------+-----------------------------------------+</span><br><span class="line">| true  | Default schema changed to [mysql.test]  |</span><br><span class="line">+-------+-----------------------------------------+</span><br><span class="line">1 row selected (0.35 seconds)</span><br><span class="line">0: jdbc:drill:zk=bigdata-test-server-02:2181&gt; show tables;</span><br><span class="line">+---------------+-------------+</span><br><span class="line">| TABLE_SCHEMA  | TABLE_NAME  |</span><br><span class="line">+---------------+-------------+</span><br><span class="line">| mysql.test    | books       |</span><br><span class="line">| mysql.test    | t1          |</span><br><span class="line">+---------------+-------------+</span><br><span class="line">2 rows selected (0.418 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=bigdata-test-server-02:2181&gt; select * from t1;</span><br><span class="line">+----+</span><br><span class="line">| a  |</span><br><span class="line">+----+</span><br><span class="line">| 1  |</span><br><span class="line">| 2  |</span><br><span class="line">+----+</span><br><span class="line">2 rows selected (1.36 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=bigdata-test-server-02:2181&gt; describe books;</span><br><span class="line">+---------------+--------------------+--------------+</span><br><span class="line">|  COLUMN_NAME  |     DATA_TYPE      | IS_NULLABLE  |</span><br><span class="line">+---------------+--------------------+--------------+</span><br><span class="line">| id            | INTEGER            | YES          |</span><br><span class="line">| isbn          | CHARACTER VARYING  | YES          |</span><br><span class="line">| category      | CHARACTER VARYING  | YES          |</span><br><span class="line">| publish_date  | TIMESTAMP          | NO           |</span><br><span class="line">| publisher     | CHARACTER VARYING  | YES          |</span><br><span class="line">| price         | REAL               | YES          |</span><br><span class="line">+---------------+--------------------+--------------+</span><br><span class="line">6 rows selected (0.239 seconds)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># jps -lm</span><br><span class="line">2099 org.apache.hadoop.hdfs.tools.DFSZKFailoverController</span><br><span class="line">14871 sun.tools.jps.Jps -lm</span><br><span class="line">1610 org.apache.zookeeper.server.quorum.QuorumPeerMain /usr/local/zookeeper-3.4.6/bin/../conf/zoo.cfg</span><br><span class="line">14613 org.apache.hadoop.hbase.master.HMaster start</span><br><span class="line">11327 org.apache.drill.exec.server.Drillbit</span><br><span class="line">1775 org.apache.hadoop.hdfs.server.namenode.NameNode</span><br><span class="line">1962 org.apache.hadoop.hdfs.qjournal.server.JournalNode</span><br></pre></td></tr></table></figure>
<h1 id="Drill-Default-Input-Format"><a href="#Drill-Default-Input-Format" class="headerlink" title="Drill Default Input Format"></a>Drill Default Input Format</h1><blockquote>
<p>参考：<a href="http://drill.apache.org/docs/drill-default-input-format/" target="_blank" rel="noopener">http://drill.apache.org/docs/drill-default-input-format/</a></p>
</blockquote>
<p>You can define one default input format per workspace. If you do not define a default input format, and Drill cannot detect the file format, the query fails. You can define a default input format for any of the file types that Drill supports. Currently, Drill supports the following types:</p>
<ul>
<li>Avro</li>
<li>CSV, TSV, or PSV</li>
<li>Parquet</li>
<li>JSON</li>
<li>MapR-DB*</li>
</ul>
<h1 id="Querying-Compressed-Files"><a href="#Querying-Compressed-Files" class="headerlink" title="Querying Compressed Files"></a>Querying Compressed Files</h1><blockquote>
<p>参考：<a href="http://drill.apache.org/docs/querying-plain-text-files/#query-the-gz-file-directly" target="_blank" rel="noopener">http://drill.apache.org/docs/querying-plain-text-files/#query-the-gz-file-directly</a></p>
</blockquote>
<blockquote>
<p>SELECT COLUMNS[0],<br>        COLUMNS[1],<br>        COLUMNS[2]<br> FROM dfs.<code>/Users/drilluser/Downloads/googlebooks-eng-all-5gram-20120701-zo.
 ts.gz</code><br>WHERE ((columns[0] = ‘Zoological Journal of the Linnean’)<br>AND (columns[2] &gt; 250))<br>LIMIT 10;</p>
</blockquote>
<h1 id="Querying-HBase"><a href="#Querying-HBase" class="headerlink" title="Querying HBase"></a>Querying HBase</h1><blockquote>
<p><a href="http://drill.apache.org/docs/querying-hbase/" target="_blank" rel="noopener">http://drill.apache.org/docs/querying-hbase/</a></p>
</blockquote>
<h1 id="Querying-the-INFORMATION-SCHEMA"><a href="#Querying-the-INFORMATION-SCHEMA" class="headerlink" title="Querying the INFORMATION SCHEMA"></a>Querying the INFORMATION SCHEMA</h1><blockquote>
<p>You can query the following INFORMATION_SCHEMA tables:</p>
<ul>
<li>SCHEMATA</li>
<li>CATALOGS</li>
<li>TABLES</li>
<li>COLUMNS</li>
<li>VIEWS</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; SELECT CATALOG_NAME, SCHEMA_NAME as all_my_data_sources FROM INFORMATION_SCHEMA.SCHEMATA ORDER BY SCHEMA_NAME;</span><br><span class="line">+---------------+----------------------+</span><br><span class="line">| CATALOG_NAME  | all_my_data_sources  |</span><br><span class="line">+---------------+----------------------+</span><br><span class="line">| DRILL         | INFORMATION_SCHEMA   |</span><br><span class="line">| DRILL         | cp.default           |</span><br><span class="line">| DRILL         | dfs.default          |</span><br><span class="line">| DRILL         | dfs.root             |</span><br><span class="line">| DRILL         | dfs.tmp              |</span><br><span class="line">| DRILL         | dfs.work             |</span><br><span class="line">| DRILL         | hbase                |</span><br><span class="line">| DRILL         | hdfs.default         |</span><br><span class="line">| DRILL         | hdfs.root            |</span><br><span class="line">| DRILL         | hive.default         |</span><br><span class="line">| DRILL         | hive.hsu             |</span><br><span class="line">| DRILL         | sys                  |</span><br><span class="line">+---------------+----------------------+</span><br><span class="line">12 rows selected (0.256 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt;  SHOW DATABASES;</span><br><span class="line">+---------------------+</span><br><span class="line">|     SCHEMA_NAME     |</span><br><span class="line">+---------------------+</span><br><span class="line">| INFORMATION_SCHEMA  |</span><br><span class="line">| cp.default          |</span><br><span class="line">| dfs.default         |</span><br><span class="line">| dfs.root            |</span><br><span class="line">| dfs.tmp             |</span><br><span class="line">| dfs.work            |</span><br><span class="line">| hbase               |</span><br><span class="line">| hdfs.default        |</span><br><span class="line">| hdfs.root           |</span><br><span class="line">| hive.default        |</span><br><span class="line">| hive.hsu            |</span><br><span class="line">| sys                 |</span><br><span class="line">+---------------------+</span><br><span class="line">12 rows selected (0.383 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; SELECT TABLE_SCHEMA, TABLE_NAME, TABLE_TYPE FROM INFORMATION_SCHEMA.`TABLES` ORDER BY TABLE_NAME DESC;</span><br><span class="line">+---------------------+---------------------+-------------+</span><br><span class="line">|    TABLE_SCHEMA     |     TABLE_NAME      | TABLE_TYPE  |</span><br><span class="line">+---------------------+---------------------+-------------+</span><br><span class="line">| sys                 | version             | TABLE       |</span><br><span class="line">| sys                 | threads             | TABLE       |</span><br><span class="line">| hive.default        | order_test_parquet  | TABLE       |</span><br><span class="line">| hive.default        | order_test          | TABLE       |</span><br><span class="line">| sys                 | options             | TABLE       |</span><br><span class="line">| sys                 | memory              | TABLE       |</span><br><span class="line">| sys                 | drillbits           | TABLE       |</span><br><span class="line">| sys                 | boot                | TABLE       |</span><br><span class="line">| INFORMATION_SCHEMA  | VIEWS               | TABLE       |</span><br><span class="line">| hbase               | TEST01              | TABLE       |</span><br><span class="line">| hbase               | TEST                | TABLE       |</span><br><span class="line">| INFORMATION_SCHEMA  | TABLES              | TABLE       |</span><br><span class="line">| hbase               | SYSTEM.STATS        | TABLE       |</span><br><span class="line">| hbase               | SYSTEM.SEQUENCE     | TABLE       |</span><br><span class="line">| hbase               | SYSTEM.CATALOG      | TABLE       |</span><br><span class="line">| INFORMATION_SCHEMA  | SCHEMATA            | TABLE       |</span><br><span class="line">| INFORMATION_SCHEMA  | COLUMNS             | TABLE       |</span><br><span class="line">| INFORMATION_SCHEMA  | CATALOGS            | TABLE       |</span><br><span class="line">| hbase               | ABC                 | TABLE       |</span><br><span class="line">+---------------------+---------------------+-------------+</span><br><span class="line">19 rows selected (1.125 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from hive.`default`.order_test;</span><br><span class="line">+-----------------+-----------------------------+</span><br><span class="line">|   ordernumber   |         event_time          |</span><br><span class="line">+-----------------+-----------------------------+</span><br><span class="line">| 10703007267488  | 2014-05-01 06:01:12.334+01  |</span><br><span class="line">1 rows selected (0.253 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; SELECT COLUMN_NAME, DATA_TYPE  FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &apos;order_test&apos; and TABLE_SCHEMA = &apos;hive.default&apos; AND COLUMN_NAME LIKE &apos;%ordernumber&apos;;</span><br><span class="line">+--------------+------------+</span><br><span class="line">| COLUMN_NAME  | DATA_TYPE  |</span><br><span class="line">+--------------+------------+</span><br><span class="line">| ordernumber  | VARCHAR    |</span><br><span class="line">+--------------+------------+</span><br><span class="line">1 row selected (1.481 seconds)</span><br></pre></td></tr></table></figure>
<h1 id="Querying-System-Tables"><a href="#Querying-System-Tables" class="headerlink" title="Querying System Tables"></a>Querying System Tables</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; show databases;</span><br><span class="line">+---------------------+</span><br><span class="line">|     SCHEMA_NAME     |</span><br><span class="line">+---------------------+</span><br><span class="line">| INFORMATION_SCHEMA  |</span><br><span class="line">| cp.default          |</span><br><span class="line">| dfs.default         |</span><br><span class="line">| dfs.root            |</span><br><span class="line">| dfs.tmp             |</span><br><span class="line">| dfs.work            |</span><br><span class="line">| hbase               |</span><br><span class="line">| hdfs.default        |</span><br><span class="line">| hdfs.root           |</span><br><span class="line">| hive.default        |</span><br><span class="line">| hive.hsu            |</span><br><span class="line">| sys                 |</span><br><span class="line">+---------------------+</span><br><span class="line">12 rows selected (0.137 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt;  use sys;</span><br><span class="line">+-------+----------------------------------+</span><br><span class="line">|  ok   |             summary              |</span><br><span class="line">+-------+----------------------------------+</span><br><span class="line">| true  | Default schema changed to [sys]  |</span><br><span class="line">+-------+----------------------------------+</span><br><span class="line">1 row selected (0.089 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; show tables;</span><br><span class="line">+---------------+-------------+</span><br><span class="line">| TABLE_SCHEMA  | TABLE_NAME  |</span><br><span class="line">+---------------+-------------+</span><br><span class="line">| sys           | boot        |</span><br><span class="line">| sys           | drillbits   |</span><br><span class="line">| sys           | memory      |</span><br><span class="line">| sys           | options     |</span><br><span class="line">| sys           | threads     |</span><br><span class="line">| sys           | version     |</span><br><span class="line">+---------------+-------------+</span><br><span class="line">6 rows selected (0.127 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from drillbits;</span><br><span class="line">+-------------------+------------+---------------+------------+----------+</span><br><span class="line">|     hostname      | user_port  | control_port  | data_port  | current  |</span><br><span class="line">+-------------------+------------+---------------+------------+----------+</span><br><span class="line">| itr-mastertest02  | 31010      | 31011         | 31012      | true     |</span><br><span class="line">| itr-mastertest01  | 31010      | 31011         | 31012      | false    |</span><br><span class="line">| itr-nodetest02    | 31010      | 31011         | 31012      | false    |</span><br><span class="line">| itr-nodetest01    | 31010      | 31011         | 31012      | false    |</span><br><span class="line">+-------------------+------------+---------------+------------+----------+</span><br><span class="line">4 rows selected (2.484 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from options where type=&apos;SYSTEM&apos; limit 10;</span><br><span class="line">+-------------------------------------------------+----------+---------+----------+-------------+-------------+-----------+------------+</span><br><span class="line">|                      name                       |   kind   |  type   |  status  |   num_val   | string_val  | bool_val  | float_val  |</span><br><span class="line">+-------------------------------------------------+----------+---------+----------+-------------+-------------+-----------+------------+</span><br><span class="line">| drill.exec.functions.cast_empty_string_to_null  | BOOLEAN  | SYSTEM  | DEFAULT  | null        | null        | false     | null       |</span><br><span class="line">| drill.exec.storage.file.partition.column.label  | STRING   | SYSTEM  | DEFAULT  | null        | dir         | null      | null       |</span><br><span class="line">| exec.errors.verbose                             | BOOLEAN  | SYSTEM  | DEFAULT  | null        | null        | false     | null       |</span><br><span class="line">| exec.java_compiler                              | STRING   | SYSTEM  | DEFAULT  | null        | DEFAULT     | null      | null       |</span><br><span class="line">| exec.java_compiler_debug                        | BOOLEAN  | SYSTEM  | DEFAULT  | null        | null        | true      | null       |</span><br><span class="line">| exec.java_compiler_janino_maxsize               | LONG     | SYSTEM  | DEFAULT  | 262144      | null        | null      | null       |</span><br><span class="line">| exec.max_hash_table_size                        | LONG     | SYSTEM  | DEFAULT  | 1073741824  | null        | null      | null       |</span><br><span class="line">| exec.min_hash_table_size                        | LONG     | SYSTEM  | DEFAULT  | 65536       | null        | null      | null       |</span><br><span class="line">| exec.queue.enable                               | BOOLEAN  | SYSTEM  | DEFAULT  | null        | null        | false     | null       |</span><br><span class="line">| exec.queue.large                                | LONG     | SYSTEM  | DEFAULT  | 10          | null        | null      | null       |</span><br><span class="line">+-------------------------------------------------+----------+---------+----------+-------------+-------------+-----------+------------+</span><br><span class="line">10 rows selected (2.842 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from boot limit 10;</span><br><span class="line">+--------------------------------------+----------+-------+---------+------------+-------------------------+-----------+------------+</span><br><span class="line">|                 name                 |   kind   | type  | status  |  num_val   |       string_val        | bool_val  | float_val  |</span><br><span class="line">+--------------------------------------+----------+-------+---------+------------+-------------------------+-----------+------------+</span><br><span class="line">| awt.toolkit                          | STRING   | BOOT  | BOOT    | null       | &quot;sun.awt.X11.XToolkit&quot;  | null      | null       |</span><br><span class="line">| drill.client.supports-complex-types  | BOOLEAN  | BOOT  | BOOT    | null       | null                    | true      | null       |</span><br><span class="line">| drill.exec.buffer.size               | STRING   | BOOT  | BOOT    | null       | &quot;6&quot;                     | null      | null       |</span><br><span class="line">| drill.exec.buffer.spooling.delete    | BOOLEAN  | BOOT  | BOOT    | null       | null                    | true      | null       |</span><br><span class="line">| drill.exec.buffer.spooling.size      | LONG     | BOOT  | BOOT    | 100000000  | null                    | null      | null       |</span><br><span class="line">| drill.exec.cluster-id                | STRING   | BOOT  | BOOT    | null       | &quot;drillbits1&quot;            | null      | null       |</span><br><span class="line">| drill.exec.compile.cache_max_size    | LONG     | BOOT  | BOOT    | 1000       | null                    | null      | null       |</span><br><span class="line">| drill.exec.compile.compiler          | STRING   | BOOT  | BOOT    | null       | &quot;DEFAULT&quot;               | null      | null       |</span><br><span class="line">| drill.exec.compile.debug             | BOOLEAN  | BOOT  | BOOT    | null       | null                    | true      | null       |</span><br><span class="line">| drill.exec.compile.janino_maxsize    | LONG     | BOOT  | BOOT    | 262144     | null                    | null      | null       |</span><br><span class="line">+--------------------------------------+----------+-------+---------+------------+-------------------------+-----------+------------+</span><br><span class="line">10 rows selected (0.138 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from threads;</span><br><span class="line">+-------------------+------------+----------------+---------------+</span><br><span class="line">|     hostname      | user_port  | total_threads  | busy_threads  |</span><br><span class="line">+-------------------+------------+----------------+---------------+</span><br><span class="line">| itr-mastertest02  | 31010      | 36             | 34            |</span><br><span class="line">| itr-nodetest02    | 31010      | 34             | 31            |</span><br><span class="line">| itr-nodetest01    | 31010      | 27             | 27            |</span><br><span class="line">| itr-mastertest01  | 31010      | 37             | 32            |</span><br><span class="line">+-------------------+------------+----------------+---------------+</span><br><span class="line">4 rows selected (9.853 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; select * from memory;</span><br><span class="line">+-------------------+------------+---------------+-------------+-----------------+---------------------+-------------+</span><br><span class="line">|     hostname      | user_port  | heap_current  |  heap_max   | direct_current  | jvm_direct_current  | direct_max  |</span><br><span class="line">+-------------------+------------+---------------+-------------+-----------------+---------------------+-------------+</span><br><span class="line">| itr-mastertest02  | 31010      | 347630584     | 1073741824  | 11798941        | 33931076            | 2147483648  |</span><br><span class="line">| itr-nodetest02    | 31010      | 182035960     | 1073741824  | 7750365         | 16813963            | 2147483648  |</span><br><span class="line">| itr-nodetest01    | 31010      | 274726896     | 1073741824  | 7750365         | 16778020            | 2147483648  |</span><br><span class="line">| itr-mastertest01  | 31010      | 455562488     | 1073741824  | 7751085         | 17151349            | 2147483648  |</span><br><span class="line">+-------------------+------------+---------------+-------------+-----------------+---------------------+-------------+</span><br><span class="line">4 rows selected (0.904 seconds)</span><br></pre></td></tr></table></figure>
<h1 id="监控WebUI"><a href="#监控WebUI" class="headerlink" title="监控WebUI"></a>监控WebUI</h1><p><a href="http://drill.apache.org/docs/monitoring-and-canceling-queries-in-the-drill-web-ui/" target="_blank" rel="noopener">http://drill.apache.org/docs/monitoring-and-canceling-queries-in-the-drill-web-ui/</a></p>
<h1 id="log-and-debug"><a href="#log-and-debug" class="headerlink" title="log-and-debug"></a>log-and-debug</h1><p><a href="http://drill.apache.org/docs/log-and-debug-introduction/" target="_blank" rel="noopener">http://drill.apache.org/docs/log-and-debug-introduction/</a></p>
<h1 id="troubleshooting"><a href="#troubleshooting" class="headerlink" title="troubleshooting"></a>troubleshooting</h1><p>  <a href="http://drill.apache.org/docs/troubleshooting/" target="_blank" rel="noopener">http://drill.apache.org/docs/troubleshooting/</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; ALTER SESSION SET `exec.errors.verbose`=true;</span><br><span class="line">+-------+-------------------------------+</span><br><span class="line">|  ok   |            summary            |</span><br><span class="line">+-------+-------------------------------+</span><br><span class="line">| true  | exec.errors.verbose updated.  |</span><br><span class="line">+-------+-------------------------------+</span><br><span class="line">1 row selected (4.051 seconds)</span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; SELECT hostname FROM sys.drillbits WHERE `current` = true;</span><br><span class="line">+-----------------+</span><br><span class="line">|    hostname     |</span><br><span class="line">+-----------------+</span><br><span class="line">| itr-nodetest02  |</span><br><span class="line">+-----------------+</span><br><span class="line">1 row selected (1.246 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:drill:zk=itr-mastertest01:2181,itr-ma&gt; SELECT commit_id FROM sys.version;</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">|                 commit_id                 |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| 13a0c3c70991f29ca240adcac32b11b0d4fef21e  |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">1 row selected (1.624 seconds)</span><br></pre></td></tr></table></figure></p>
<p><code>注意：</code></p>
<blockquote>
<p>当指定的zk是一个全新的ZK, 之前如果使用zk=local在本次新的zk会话中<br>Storage-Plugin的信息都丢失.<br>因为我们指定的zookeeper集群是全新的. 所以drill还没有往里面写入任何数据.<br>这是因为在web ui上对Storage   Plugin进行update或者create的数据都会写入到对应的zookeeper节点上!<br>当我们在界面上update hive, 并且enable后, 通过show   databases就可以看到hive里的表.</p>
</blockquote>
<ul>
<li>本文利用了一天时间完成,从零开始部署使用,转载请注明出处<a href="http://www.itweet.cn/" target="_blank" rel="noopener">www.itweet.cn</a></li>
</ul>
<p>参考：<a href="http://www.yankay.com/google-dremel-rationale/" target="_blank" rel="noopener">http://www.yankay.com/google-dremel-rationale/</a></p>
<p>相关资源：<a href="http://geek.csdn.net/news/detail/32952" target="_blank" rel="noopener">http://geek.csdn.net/news/detail/32952</a><br>          <a href="http://www.quora.com/Apache-Drill" target="_blank" rel="noopener">http://www.quora.com/Apache-Drill</a></p>
<p>原创文章，转载请注明： 转载自<a href="http://www.itweet.cn" target="_blank" rel="noopener">Itweet</a>的博客<br><code>本博客的文章集合:</code> <a href="http://www.itweet.cn/blog/archive/" target="_blank" rel="noopener">http://www.itweet.cn/blog/archive/</a></p>

            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/tags/SQL/">SQL</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2015/07/20/tez-use/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">tez-use</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2015/07/17/mahout-engine/">
        <span class="next-text nav-default">mahout-engine</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2019
    <span class="footer-author">Xu Jiang.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/realXuJiang/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
