<!DOCTYPE html>
<html lang="zh-CN">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="gunpg-use">




  <meta name="keywords" content="gun,">





  <link rel="alternate" href="/atom.xml" title="WHOAMI">




  <link rel="shortcut icon" type="image/x-icon" href="https://raw.githubusercontent.com/itweet/itweet.github.io/master/favicon.ico?v=1.1">



<link rel="canonical" href="http://itweet.github.io/2015/10/14/gunpg-use/">


<meta name="description" content="GnuPG（GNU Privacy Guard或GPG）是一个以GNU通用公共许可证释出的开放源码用于加密或签名的软件，可用来取代PGP。大多数gpg软件仅支持命令行方式，一般人较难掌握。由于gpg软件开放源代码，很难隐藏后门，因此比pgp等商业软件安全。 install gnupg12whoami@ubuntu:~$ sudo apt-get install gnupg #for ubuntuw">
<meta name="keywords" content="gun">
<meta property="og:type" content="article">
<meta property="og:title" content="gunpg-use">
<meta property="og:url" content="http://itweet.github.io/2015/10/14/gunpg-use/index.html">
<meta property="og:site_name" content="WHOAMI">
<meta property="og:description" content="GnuPG（GNU Privacy Guard或GPG）是一个以GNU通用公共许可证释出的开放源码用于加密或签名的软件，可用来取代PGP。大多数gpg软件仅支持命令行方式，一般人较难掌握。由于gpg软件开放源代码，很难隐藏后门，因此比pgp等商业软件安全。 install gnupg12whoami@ubuntu:~$ sudo apt-get install gnupg #for ubuntuw">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-12-25T14:39:06.106Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="gunpg-use">
<meta name="twitter:description" content="GnuPG（GNU Privacy Guard或GPG）是一个以GNU通用公共许可证释出的开放源码用于加密或签名的软件，可用来取代PGP。大多数gpg软件仅支持命令行方式，一般人较难掌握。由于gpg软件开放源代码，很难隐藏后门，因此比pgp等商业软件安全。 install gnupg12whoami@ubuntu:~$ sudo apt-get install gnupg #for ubuntuw">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1">
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  <script id="baidu_analytics">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b75d841b3068f7782eac9af2c8c866e7";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-154998721-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-154998721-1');
</script>


    <title> gunpg-use - WHOAMI </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">WHOAMI</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/atom.xml">
                            
                            
                                RSS
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          gunpg-use
        
      </h1>

      <time class="post-time">
          10月 14 2015
      </time>
    </header>



    
            <div class="post-content">
            <p>GnuPG（GNU Privacy Guard或GPG）是一个以GNU通用公共许可证释出的开放源码用于加密或签名的软件，可用来取代PGP。大多数gpg软件仅支持命令行方式，一般人较难掌握。由于gpg软件开放源代码，很难隐藏后门，因此比pgp等商业软件安全。</p>
<h1 id="install-gnupg"><a href="#install-gnupg" class="headerlink" title="install gnupg"></a>install gnupg</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">whoami@ubuntu:~$ sudo apt-get install gnupg #for ubuntu</span><br><span class="line">whoami@centos:~$  yum install gnupg #for centos</span><br></pre></td></tr></table></figure>
<h1 id="generate-key"><a href="#generate-key" class="headerlink" title="generate key"></a>generate key</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">whoami@ubuntu:~$  gpg --gen-key</span><br><span class="line">gpg (GnuPG) 1.4.16; Copyright (C) 2013 Free Software Foundation, Inc.</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line"></span><br><span class="line">gpg: 已创建目录‘/home/whoami/.gnupg’</span><br><span class="line">gpg: 新的配置文件‘/home/whoami/.gnupg/gpg.conf’已建立</span><br><span class="line">gpg: 警告：在‘/home/whoami/.gnupg/gpg.conf’里的选项于此次运行期间未被使用</span><br><span class="line">gpg: 钥匙环‘/home/whoami/.gnupg/secring.gpg’已建立</span><br><span class="line">gpg: 钥匙环‘/home/whoami/.gnupg/pubring.gpg’已建立</span><br><span class="line">请选择您要使用的密钥种类：</span><br><span class="line">   (1) RSA and RSA (default)</span><br><span class="line">   (2) DSA and Elgamal</span><br><span class="line">   (3) DSA (仅用于签名)</span><br><span class="line">   (4) RSA (仅用于签名)</span><br><span class="line">您的选择？ 1</span><br><span class="line">RSA 密钥长度应在 1024 位与 4096 位之间。</span><br><span class="line">您想要用多大的密钥尺寸？(2048) </span><br><span class="line">您所要求的密钥尺寸是 2048 位</span><br><span class="line">请设定这把密钥的有效期限。</span><br><span class="line">         0 = 密钥永不过期</span><br><span class="line">      &lt;n&gt;  = 密钥在 n 天后过期</span><br><span class="line">      &lt;n&gt;w = 密钥在 n 周后过期</span><br><span class="line">      &lt;n&gt;m = 密钥在 n 月后过期</span><br><span class="line">      &lt;n&gt;y = 密钥在 n 年后过期</span><br><span class="line">密钥的有效期限是？(0) 0</span><br><span class="line">密钥永远不会过期</span><br><span class="line">以上正确吗？(y/n) y</span><br><span class="line"></span><br><span class="line">您需要一个用户标识来辨识您的密钥；本软件会用真实姓名、注释和电子邮件地址组合</span><br><span class="line">成用户标识，如下所示：</span><br><span class="line">    “Heinrich Heine (Der Dichter) &lt;heinrichh@duesseldorf.de&gt;”</span><br><span class="line"></span><br><span class="line">真实姓名： whoami</span><br><span class="line">电子邮件地址： whoami.itweet@qq.com</span><br><span class="line">注释： whoami</span><br><span class="line">您选定了这个用户标识：</span><br><span class="line">    “whoami (whoami) &lt;whoami.itweet@qq.com&gt;”</span><br><span class="line"></span><br><span class="line">更改姓名(N)、注释(C)、电子邮件地址(E)或确定(O)/退出(Q)？ o</span><br><span class="line">您需要一个密码来保护您的私钥。</span><br><span class="line"></span><br><span class="line">我们需要生成大量的随机字节。这个时候您可以多做些琐事(像是敲打键盘、移动</span><br><span class="line">鼠标、读写硬盘之类的)，这会让随机数字发生器有更好的机会获得足够的熵数。</span><br><span class="line"></span><br><span class="line">随机字节不够多。请再做一些其他的琐事，以使操作系统能搜集到更多的熵！</span><br><span class="line">(还需要198字节)</span><br><span class="line"></span><br><span class="line">*******如果提示你以上你可以新开一个终端，在命令行执行tree /</span><br><span class="line"></span><br><span class="line">.....+++++</span><br><span class="line">+++++</span><br><span class="line">我们需要生成大量的随机字节。这个时候您可以多做些琐事(像是敲打键盘、移动</span><br><span class="line">鼠标、读写硬盘之类的)，这会让随机数字发生器有更好的机会获得足够的熵数。</span><br><span class="line"></span><br><span class="line">随机字节不够多。请再做一些其他的琐事，以使操作系统能搜集到更多的熵！</span><br><span class="line">(还需要74字节)</span><br><span class="line">............+++++</span><br><span class="line"></span><br><span class="line">...+++++</span><br><span class="line">gpg: /home/whoami/.gnupg/trustdb.gpg：建立了信任度数据库</span><br><span class="line">gpg: 密钥 CC5E7372 被标记为绝对信任</span><br><span class="line">公钥和私钥已经生成并经签名。</span><br><span class="line"></span><br><span class="line">gpg: 正在检查信任度数据库</span><br><span class="line">gpg: 需要 3 份勉强信任和 1 份完全信任，PGP 信任模型</span><br><span class="line">gpg: 深度：0 有效性：  1 已签名：  0 信任度：0-，0q，0n，0m，0f，1u</span><br><span class="line">pub   2048R/CC5E7372 2015-10-14</span><br><span class="line">      密钥指纹 = 96D4 36CC 5871 F7EA 0509  162E 1686 DC44 CC5E 7372</span><br><span class="line">uid                  whoami (whoami) &lt;whoami.itweet@qq.com&gt;</span><br><span class="line">sub   2048R/9F7266CD 2015-10-14</span><br></pre></td></tr></table></figure>
<h1 id="show-key"><a href="#show-key" class="headerlink" title="show key"></a>show key</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">whoami@ubuntu:~$ gpg --list-keys</span><br><span class="line">/home/whoami/.gnupg/pubring.gpg</span><br><span class="line">-------------------------------</span><br><span class="line">pub   2048R/CC5E7372 2015-10-14</span><br><span class="line">uid                  whoami (whoami) &lt;whoami.itweet@qq.com&gt;</span><br><span class="line">sub   2048R/9F7266CD 2015-10-14</span><br><span class="line"></span><br><span class="line">从中我们可以看到刚才生成的钥匙对的公钥部分，其中：</span><br><span class="line"></span><br><span class="line">CC5E7372 是这个公钥的id，这个id跟uid都是用于标识这个公钥的，因为uid是用户随便输入的所以会有重复的情况，因此在某些需要明确指定公钥的命令，需要用id而不能用uid表示这个公钥。另外在使用这个id表示一个钥匙时，记得在前面加上”0x”，是零和字母XYZ的X，比如”0xCC5E7372″</span><br><span class="line">2013-04-17 是生成这个公钥的时间，后面括号内的是有效期。</span><br><span class="line">在实际应用中，因为要发送加密信息给你的朋友就需要对方的公钥，所以在本机上可能会有多个朋友的公钥，但私钥往往只有一个，也就是自己的私钥。使用下面命令可以查看本机上的私钥。</span><br><span class="line"></span><br><span class="line">whoami@ubuntu:~$ gpg --list-secret-keys</span><br></pre></td></tr></table></figure>
<h1 id="output-public-key"><a href="#output-public-key" class="headerlink" title="output public key"></a>output public key</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">whoami@ubuntu:~$ gpg -a --output key.public --export UID</span><br><span class="line">注：你要把其中的 UID 替换成你的名字或者email地址。</span><br><span class="line"></span><br><span class="line">其中参数</span><br><span class="line"></span><br><span class="line">    -a 表示输出文本文件格式。默认输出是二进制格式，因为二进制格式不太方便在网络（比如论坛或者博客）上展示，所以推荐文本格式。</span><br><span class="line">    –output 指定输出文件的名字，你可以更改为其他名字。</span><br><span class="line">    –export 表示执行输出公钥操作，后面的 UID 为你要输出的公钥的标识。</span><br><span class="line"></span><br><span class="line">whoami@ubuntu:~$ cat key.public </span><br><span class="line">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><br><span class="line">Version: GnuPG v1</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">-----END PGP PUBLIC KEY BLOCK-----</span><br></pre></td></tr></table></figure>
<h1 id="send-public-key-to-public-key-server"><a href="#send-public-key-to-public-key-server" class="headerlink" title="send public key to public-key server"></a>send public key to public-key server</h1><blockquote>
<p>公钥导出之后，你可以通过各种方式把它发送给你的朋友，比如email或者聊天工具。而<br>比较方便的是把公钥发布到公钥服务器。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">whoami@ubuntu:~$ gpg --keyserver keys.gnupg.net --send-key PID</span><br><span class="line">gpg: 将密钥‘PID’上传到 hkp 服务器 keys.gnupg.net</span><br><span class="line"></span><br><span class="line">注：你要把其中的 PID 替换成你公钥的id。</span><br><span class="line"></span><br><span class="line">其中参数：</span><br><span class="line"></span><br><span class="line">    –keyserver 用于指定公钥服务器，没有特殊需求的话是可以省略这个参数的，不过有些 GnuPG 版本可能需要指定这个参数才能正常工作。</span><br><span class="line">    –send-key 用于指定待发布的公钥的id。</span><br><span class="line"></span><br><span class="line">好了，至此你已经学会生成钥匙对以及发布公钥了。</span><br></pre></td></tr></table></figure>
<h1 id="use-command-gpg-file"><a href="#use-command-gpg-file" class="headerlink" title="use command gpg file"></a>use command gpg file</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">1、在公钥服务器搜索作者的公钥并导入到本机</span><br><span class="line">whoami@ubuntu:~$ gpg --keyserver keys.gnupg.net --search-key whoami</span><br><span class="line">参数 –search-key 用于指定搜索关键字，可以是uid的名字或者email地址部分。结果大致如下：</span><br><span class="line"></span><br><span class="line">gpg: 搜索“whoami”，在 hkp 服务器 keys.gnupg.net 上</span><br><span class="line">(1) whoami (whoami) &lt;whoami.itweet@qq.com&gt;</span><br><span class="line">      2048 bit RSA key CC5E7372, 创建于：2015-10-14</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">whoami@ubuntu:~$  gpg --keyserver keys.gnupg.net --recv-key 0xCC5E7372</span><br><span class="line">gpg: 下载密钥‘CC5E7372’，从 hkp 服务器 keys.gnupg.net</span><br><span class="line">gpgkeys: key CC5E7372 not found on keyserver</span><br><span class="line">gpg: 找不到有效的 OpenPGP 数据。</span><br><span class="line">gpg: 合计被处理的数量：0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 这里需要时间同步，所以不能立即查询到！</span><br><span class="line"></span><br><span class="line">如果你朋友已经发送给你了 key.public公钥文件，通过下面命令直接导入你朋友的公钥</span><br><span class="line">whoami@ubuntu:~$ gpg --import key.public</span><br><span class="line"></span><br><span class="line">2、核对公钥的指纹值并签收公钥</span><br><span class="line"> 因为公钥有可能出现冒牌货，所以每个公钥里都加入了指纹值，使用下面命令可以查看指纹值</span><br><span class="line"></span><br><span class="line">whoami@ubuntu:~$  gpg --fingerprint</span><br><span class="line">/home/whoami/.gnupg/pubring.gpg</span><br><span class="line">-------------------------------</span><br><span class="line">pub   2048R/CC5E7372 2015-10-14</span><br><span class="line">      密钥指纹 = 96D4 36CC 5871 F7EA 0509  162E 1686 DC44 CC5E 7372</span><br><span class="line">uid                  whoami (whoami) &lt;whoami.itweet@qq.com&gt;</span><br><span class="line">sub   2048R/9F7266CD 2015-10-14</span><br><span class="line"></span><br><span class="line">确定取得的公钥是真货之后，使用如下命令对这个公钥进行签收（sign key）：</span><br><span class="line">whoami@ubuntu:~$ gpg --sign-key whoami</span><br><span class="line"></span><br><span class="line">pub  2048R/CC5E7372  创建于：2015-10-14  有效至：永不过期       可用于：SC  </span><br><span class="line">                     信任度：绝对        有效性：绝对</span><br><span class="line"></span><br><span class="line">运行上面的命令之后它提示你再确认一次指纹值，输入y并按回车确定。</span><br><span class="line"></span><br><span class="line">提示，如果发现获取回来的是冒牌货，可以使用如下的命令删除它：</span><br><span class="line"></span><br><span class="line">whoami@ubuntu:~$ gpg --delete-keys whoami</span><br><span class="line"></span><br><span class="line">3、加密一个文件</span><br><span class="line">whoami@ubuntu:~$ gpg -a --output mm-ciper.cfg -r whoami.itweet@qq.com -e mm.cfg </span><br><span class="line"></span><br><span class="line">中参数：</span><br><span class="line"></span><br><span class="line">    -a 表示输出文本文件格式。</span><br><span class="line">    –output 指定输出（即加密后）的文件名。</span><br><span class="line">    -r 指定信息的接收者（recipient）公钥的uid，可以是名字也可以是email地址。</span><br><span class="line">    -e 表示这次要执行的是加密（encrypt）操作。</span><br><span class="line"></span><br><span class="line">执行完毕之后会在当前文件夹产生文件 mm-ciper.cfg，这个就是被加密之后的文件。</span><br><span class="line"></span><br><span class="line">注：如果你要加密的是一个二进制文件，则可以省略 -a 参数，这样产生的加密文件的体积会小一些</span><br><span class="line"></span><br><span class="line">4、解密一个文件</span><br><span class="line">whoami@ubuntu:~$ gpg --output mm-plain.txt -d mm-ciper.cfg </span><br><span class="line">                #注：第一次这里会提示输入密码，为你刚开始使用gpg设置的秘密</span><br><span class="line"></span><br><span class="line">其中参数：</span><br><span class="line"></span><br><span class="line">    –output 指定输出（即解密后）的文件名。</span><br><span class="line">    -d 表示这次要执行的是解密（decrypt）操作。</span><br><span class="line">    GnuPG程序会自动使用我的私钥来解密信息，最后得到一个跟原始内容一样的文本文件mm-plain.txt。</span><br><span class="line"></span><br><span class="line">至此，你已经学会使用 GnuPG 加密解密文件了。</span><br><span class="line"></span><br><span class="line">提示1：导入公钥、核对公钥的指纹值、签名公钥这些操作你只需做一次，以后就可以重复多次使用该公钥加密信息并发送给对方。</span><br><span class="line"></span><br><span class="line">提示2：如果你想自己体会整个加密和解密过程，可以用自己的公钥加密信息，然后用自己的私钥解密，只需把上面第3步的命令当中的接收者uid（whoami@qq.com）更改为自己的uid即可。</span><br></pre></td></tr></table></figure>
<h1 id="使用命令行对文件进行数字签名"><a href="#使用命令行对文件进行数字签名" class="headerlink" title="使用命令行对文件进行数字签名"></a>使用命令行对文件进行数字签名</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">1、数字签名一个文件的方法A</span><br><span class="line">whoami@ubuntu:~$ gpg -a -b mm.cfg </span><br><span class="line">其中参数</span><br><span class="line"></span><br><span class="line">    -a 表示输出文本文件格式。</span><br><span class="line">    -b 表示以生成独立的签名文件的方式进行签名。</span><br><span class="line">命令执行完毕之后，会在当前文件夹里产生一个 mm.cfg.asc 的文件，这个文件即签名。现在我应该把原信息文件 mm.cfg 连同签名文件 mm.cfg.asc 一起寄给你，然后你使用如下命令检验：</span><br><span class="line"></span><br><span class="line">whoami@ubuntu:~$ gpg --verify mm.cfg.asc </span><br><span class="line">gpg: 于 2015年10月14日 星期三 17时15分18秒 CST 创建的签名，使用 RSA，钥匙号 CC5E7372</span><br><span class="line">gpg: 完好的签名，来自于“whoami (whoami) &lt;whoami.itweet@qq.com&gt;”</span><br><span class="line"></span><br><span class="line">其中最重要的是 “Good signature” 字样，表示通过检验，否则表示没通过检验（即意味着原信息的内容被篡改或者原信息不是我发出的）。</span><br><span class="line"></span><br><span class="line">提示：如果你有多个私钥，在签名时需要加上参数 -u 指定私钥的 uid。</span><br><span class="line"></span><br><span class="line">2、数字签名一个文件的方法B</span><br><span class="line">如果不想生成一个独立的签名文件，则还可以用如下的命令进行签名：</span><br><span class="line">whoami@ubuntu:~$ gpg -a --clearsign mm.cfg </span><br><span class="line"></span><br><span class="line">跟方法A不同的地方是用参数 –clearsign 替代了参数 -b。参数 clearsign 表示将签名和原信息合并在一起，并生成一个新文件。</span><br><span class="line"></span><br><span class="line">命令运行后同样会生成一个文件 mm.cfg.asc，内容如下：</span><br><span class="line">whoami@ubuntu:~$ cat mm.cfg.asc </span><br><span class="line">-----BEGIN PGP SIGNED MESSAGE-----</span><br><span class="line">Hash: SHA1</span><br><span class="line">xxx</span><br><span class="line">xxx</span><br><span class="line">-----BEGIN PGP SIGNATURE-----</span><br><span class="line">Version: GnuPG v1</span><br><span class="line"></span><br><span class="line">iQEcBAEBAgAGBQJWHh4HAAoJEBaG3ETMXnNyxGAH/0bDL/J3kcLjbgtJdjrncbN6</span><br><span class="line">ARq6W+V+05jnm8Uv7KlT7I2cs4ujerLY89ahfRdU0LQlW36Gs+GhonOM0JwvuyMP</span><br><span class="line">bpwARW7ZBswWfY6HVgoc3taTlVaoIezYVnlryBXn7Kr7/PJfkZpX/Ig7UiH4wd60</span><br><span class="line">UT/3h1cz/qfx2aH4PSggX6ersj/DadVMHSQVb+0OZrAlBwqbglEj2eZRfBiZMfNF</span><br><span class="line">YK6tTKJKtE2blLemtQh8xAcTWq++BZdR8oFbXE26IoUhNWRz5VkNRMaABduX4+K6</span><br><span class="line">qwiR1/j4N0Ureu7WFQuN/6vhOgd1hDkLQhfPxFMpcehqA/Oqq3XIztBs0Ye9LZc=</span><br><span class="line">=xfIv</span><br><span class="line">-----END PGP SIGNATURE-----</span><br><span class="line"></span><br><span class="line">使用如下命令进行检验：</span><br><span class="line">whoami@ubuntu:~$ gpg --verify mm.cfg.asc</span><br><span class="line"></span><br><span class="line">使用如下命令可以把原始信息提取出来：</span><br><span class="line">    whoami@ubuntu:~$ gpg --output mm-original.txt -d mm.cfg.asc</span><br><span class="line"></span><br><span class="line">至此已经讲完 GnuPG 的基本操作了，如果你还想更深入了解它，这里有几篇官方的文档，推荐阅读一下：</span><br><span class="line"></span><br><span class="line">迷你Howto教程：http://www.dewinter.com/gnupg_howto/english/GPGMiniHowto.html</span><br><span class="line">迷你Howto教程（中文版）： http://www.gnupg.org/howtos/zh/index.html</span><br><span class="line">The GNU Privacy Handbook http://www.gnupg.org/gph/en/manual.html</span><br><span class="line">另外 wiki 对 OpenPGP 的讲解也很有值得阅读：</span><br><span class="line"></span><br><span class="line">Pretty Good Privacy http://en.wikipedia.org/wiki/Pretty_Good_Privacy</span><br><span class="line">还有一些本文未提到但会用得上的命令：</span><br><span class="line"></span><br><span class="line">Quick’n easy gpg cheatsheet http://irtfweb.ifa.hawaii.edu/~lockhart/gpg/</span><br></pre></td></tr></table></figure>

            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/tags/gun/">gun</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2015/10/21/恐怖的大数据/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">恐怖的大数据</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2015/09/30/net-snmp/">
        <span class="next-text nav-default">net-snmp</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
    <div style="text-align:center;">
        <button class="btn" id="load-disqus" onclick="disqus.load();">加载 Disqus 评论</button>
    </div>
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2023
    <span class="footer-author">Xu Jiang.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/realXuJiang/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    

<script type="text/javascript">
  var disqus_shortname = 'itweet-cn';
  var disqus_identifier = '2015/10/14/gunpg-use/';

  var disqus_title = "gunpg-use";


  var disqus = {
    load : function disqus(){
        if(typeof DISQUS !== 'object') {
          (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
          }());
          $('#load-disqus').remove(); ///加载后移除按钮
        }
    }
  }

  
    var disqus_config = function () {
        this.page.url = disqus_url;
        this.page.identifier = disqus_identifier;
        this.page.title = disqus_title;
    };
  

</script>


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
